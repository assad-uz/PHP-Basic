Q: AFTER DELETE and BEFORE DELETE trigger in mysql ржП ржжрзБржЯрзЛрж░ ржоржзрзНржпрзЗ ржкрж╛рж░рзНржержХрзНржп ржХрж┐?
A:
MySQL-ржП AFTER DELETE ржПржмржВ BEFORE DELETE trigger ржжрзБржЯрж┐рж░ ржоржзрзНржпрзЗ ржорзВрж▓ ржкрж╛рж░рзНржержХрзНржп рж╣рж▓рзЛ ржХржЦржи trigger ржЯрж┐ execute рж╣ржпрж╝ ржПржмржВ ржХрзА ржХрзА ржХрж░рждрзЗ ржкрж╛рж░рж╛ ржпрж╛ржпрж╝ рждрж╛ ржирж┐рж░рзНржнрж░ ржХрж░рзЗ рж╕рзЗржЗ ржЯрж╛ржЗржорж┐ржВрзЯрзЗрж░ ржУржкрж░ред

ЁЯФ╣ 1. BEFORE DELETE Trigger:
ржХржЦржи ржЪрж▓рзЗ: ржорзВрж▓ DELETE ржХрж╛ржЬржЯрж┐ рж╢рзБрж░рзБ рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗ trigger ржЯрж┐ execute рж╣рзЯред

ржмрзНржпржмрж╣рж╛рж░: рж╕рж╛ржзрж╛рж░ржгржд validation ржмрж╛ рж░рзЗржХрж░рзНржбржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рж╛рж░ ржЖржЧрзЗ ржХрзЛржирзЛ ржЪрзЗржХ, рж▓ржЬрж┐ржХ ржмрж╛ рж╣рж┐рж╕рж╛ржм-ржирж┐ржХрж╛рж╢ ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред

ржХрж╛ржЬ: ржЖржкржирж┐ рж░рзЗржХрж░рзНржб ржорзБржЫрзЗ ржлрзЗрж▓рж╛рж░ ржЖржЧрзЗ рждрж╛ржХрзЗ ржпрж╛ржЪрж╛ржЗ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржмрж╛ ржЕржирзНржп ржХрзЛржирзЛ ржЯрзЗржмрж┐рж▓рзЗ log рж░рж╛ржЦрждрзЗ ржкрж╛рж░рзЗржи, ржПржоржиржХрж┐ ржмрж┐рж╢рзЗрж╖ рж╢рж░рзНрждрзЗ delete ржирж╛ ржХрж░рждрзЗржУ ржкрж╛рж░рзЗржиред

ЁЯУМ ржЙржжрж╛рж╣рж░ржг:

CREATE TRIGGER before_delete_student
BEFORE DELETE ON students
FOR EACH ROW
BEGIN
  INSERT INTO deleted_log (student_id, name, deleted_at)
  VALUES (OLD.id, OLD.name, NOW());
END;
ЁЯСЙ ржПржЦрж╛ржирзЗ ржорзВрж▓ students ржЯрзЗржмрж┐рж▓ ржерзЗржХрзЗ рж░рзЗржХрж░рзНржб ржорзБржЫрзЗ ржлрзЗрж▓рж╛рж░ ржЖржЧрзЗржЗ ржЖржорж░рж╛ deleted_log ржЯрзЗржмрж┐рж▓рзЗ рждрж╛рж░ рждржерзНржп рж╕ржВрж░ржХрзНрж╖ржг ржХрж░ржЫрж┐ред

ЁЯФ╣ 2. AFTER DELETE Trigger:
ржХржЦржи ржЪрж▓рзЗ: ржорзВрж▓ DELETE рж╕ржлрж▓ржнрж╛ржмрзЗ рж╣рзЯрзЗ ржЧрзЗрж▓рзЗ рждрж╛рж░ ржкрж░рзЗ trigger ржЯрж┐ execute рж╣рзЯред

ржмрзНржпржмрж╣рж╛рж░: delete рж╣рзЯрзЗ ржпрж╛ржУрзЯрж╛рж░ ржкрж░рзЗ log рж░рж╛ржЦрж╛, ржЕржирзНржп ржЯрзЗржмрж┐рж▓ ржЖржкржбрзЗржЯ ржХрж░рж╛ ржЗрждрзНржпрж╛ржжрж┐рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред

ржХрж╛ржЬ: ржпрзЗрж╣рзЗрждрзБ рж░рзЗржХрж░рзНржб ржЗрждрж┐ржоржзрзНржпрзЗ delete рж╣ржпрж╝рзЗ ржЧрзЗржЫрзЗ, рждрж╛ржЗ ржЖрж░рзЗржХржЯрж┐ ржЯрзЗржмрж┐рж▓рзЗ ржПрж░ ржкрзНрж░ржнрж╛ржм ржлрзЗрж▓рждрзЗ ржмрж╛ ржЕржирзБрж╕рзНржорзГрждрж┐ рж░рж╛ржЦрждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред

ЁЯУМ ржЙржжрж╛рж╣рж░ржг:

CREATE TRIGGER after_delete_student
AFTER DELETE ON students
FOR EACH ROW
BEGIN
  INSERT INTO archive_students (id, name, deleted_at)
  VALUES (OLD.id, OLD.name, NOW());
END;
ЁЯСЙ ржПржЦрж╛ржирзЗ рж░рзЗржХрж░рзНржб delete рж╣ржУрзЯрж╛рж░ ржкрж░рзЗ, ржЖржорж░рж╛ рждрж╛ржХрзЗ archive_students ржЯрзЗржмрж┐рж▓рзЗ ржкрж╛ржарж┐рзЯрзЗ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░ржЫрж┐ред

ЁЯФ╕ рж╕ржВржХрзНрж╖рзЗржкрзЗ ржкрж╛рж░рзНржержХрзНржп:
ржжрж┐ржХ          	              BEFORE DELETE                               	AFTER DELETE
Execute рж╣ржпрж╝	                   Delete рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗ	                          Delete рж╣ржУрзЯрж╛рж░ ржкрж░рзЗ
Rollback рж╕ржорзНржнрж╛ржмржирж╛	   Trigger ржЪрж╛рж▓рж╛ржирзЛрж░ ржкрж░ DELETE ржЖржЯржХрж╛ржирзЛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ	    DELETE ржЗрждрж┐ржоржзрзНржпрзЗ рж╣рзЯрзЗ ржЧрзЗржЫрзЗ
ржмрзНржпржмрж╣рж╛рж░                   	Validation, canceling, logging          	Archiving, auditing, logging